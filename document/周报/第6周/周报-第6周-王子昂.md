# 第6周周报——王子昂 #

## 得到各个月热度排行榜 ##

> 以8月为例，爬取各个话题2018年的微博信息，得到微博数、转发数、评论数、点赞数

* 所有的话题id编号及关键词如下：

![1565508651847](周报-第6周-王子昂.assets/1565508651847.png)

* 按照上周周报中提到的方法，计算各个话题的热度
* 按照热度值排序，得到热度排行榜

## 热度趋势预测 ##

### 灰色预测 ###

微博话题的强度受到社会环境和个人环境等各个因素的影响，可以将其认为是一个无规律可循的灰色系统，尝试采用灰色模型 GM(1,1,) 对其情感进行变化进行预测，预测模型过程如下：

1. 设微博话题情感时间序列为 $x^{0}=\left\{x^{0}(1), x^{0}(2)\right.,\cdots, x^{0}(n) \}$，由于微博情感的随机程度较大，我们将原始情感时间序列进行累加处理，以增加数据的平稳性，累加后的话题情感时间序列为$x^{1}=\left\{x^{1}(1), x^{1}(2), \cdots, x^{1}(n)\right\}$，其中$x^{1}(n)=\sum_{i=1}^{n} x^{(0)}(n)$

2. 用微分方程近似地描述微博情感新的时间序列变化趋势，其计算公式为：
   $$
   \frac{\mathrm{d} x^{(1)}(t)}{\mathrm{d} t}+a x^{(1)}(t)=u
   $$

3. 参数a，u通过最小二乘法拟合获得，其拟合公式为：
   $$
   \left(\begin{array}{l}{a} \\ {u}\end{array}\right)=\left(B^{T} B\right)^{-i} B^{T} Y_{n}
   $$

   * 其中 $Y_n$ 为原始微博情感序列，其值为$Y_{n}=\left[x^{(0)}(2), x^{0}\right.(3), \cdots, x^{0}(n) ]^{T}$，B为构造微博情感数据矩阵，其值为：
     $$
     B=\left[\begin{array}{ccc}{-\frac{1}{2}\left[x^{\prime}(1)+x^{1}(2)\right]} & {1} \\ {-\frac{1}{2}\left[x^{\prime}(1)+x^{1}(2)\right]} & {1} \\ {\vdots} & {} \\ {-\frac{1}{2}\left[x^{1}(1)+x^{1}(2)\right]} & {1}\end{array}\right]
     $$

4. 将获取的a和w的值代入微分方程，得到微博情感累加随时间变化的函数，其变化函数为：
   $$
   x^{1}(t+1)=\left[x^{(0)}(1)-\frac{u}{a}\right] e^{-\alpha t}+\frac{u}{a}
   $$

5. 根据微博情感累加值，计算微博第t+1时刻的情感预测值，计算方式如下：
   $$
   x^{(0)}(t+1)=x^{1}(t+1)-x^{1}(t)
   $$

#### 预测结果及分析 ####

![1565512039120](周报-第6周-王子昂.assets/1565512039120.png)

* 相比较传统统计学方法其预测结果的精确度有一定的提高。
* 灰色模型对随机波动性较大的数据预测效果较差，不宜使用灰色预测法

### GPR ###

> 高斯过程回归（Gaussian Process Regression，GPR）是一种基于贝叶斯网络的机器学习算法，不仅具有贝叶斯网络推理能力，可解释性强，同时具有了支持向量机的小样本、非线性、高维等问题的自适应处理能力，大量研究实践表明，相对于支持向量机和神经网络，GPR模型具有易实现、泛化能力更强等优点，可以获得较好的建模性能

#### 高斯过程回归模型 ####

给定训练集$D :\left\{\boldsymbol{X}_{i}, t_{i}\right\}_{i=1}^{N}$，N为训练样本数，$X_i$为对应$t_i$时刻的向量，高斯过程的随机变量联合概率分布函数为：
$$
P\left(t | C\left(X_{m}, X_{n} ; \Theta\right),\left\{X_{n}\right\}\right)=\frac{1}{Z} \exp (-\frac{1}{2}(t-\mu)^{\mathrm{T}}\cdot\\ C\left(\boldsymbol{X}_{m}, \boldsymbol{X}_{n} ; \boldsymbol{\Theta}\right)^{-1}(\boldsymbol{t}-\boldsymbol{\mu}) )
$$

* $X_m$和$X_n$，表示第m和n个向量
* $C\left(X_{m}, X_{n} ; \Theta\right)$为参数协方差函数
* $\mu$为均值向量

协方差函数为：
$$
C\left(X_{m}, X_{n} ; \Theta\right)=\theta_{1} \exp \left(-\frac{1}{2} \sum_{l=1}^{L} \frac{\left(X_{m}^{(l)}-X_{n}^{(l)}\right)^{2}}{\delta^{2}}\right)+\theta_{2}
$$

* L为向量$X_i$中元素个数
* $\delta$为方差
* $\theta_1,\theta_2$为参数

对于一个新输入向量$X_{N+1}$，采用预测模型对其$t_{N+1}$的概率分布、期望和方差进行预测，设模型函数表示形式为：
$$
t_{n}=y\left(\boldsymbol{X}_{n}\right)+v_{n}
$$

* $y\left(\boldsymbol{X}_{n}\right)$是模型函数
* $v_n$是预测误差

模型概率为：
$$
P(T_{N}|\left\{X_{n}\}, A, B\right)=\int P\left(T_{N} |\left\{X_{n}\right\}, y, v\right) P(y | A)\cdot P(v | B) \mathrm{d} y \mathrm{d} v
$$

* $P(y|A)$为 $y(x)$ 的事先概率分布
* A是$P(y|A)$的一组超参数
* $P(v|B)$为预测误差的事先概率分布
* B是表示误差v的参数

令$T_{N}=\left(t_{1}, t_{2}, \cdots, t_{N}\right), T_{N+1}=\left(t_{1}, t_{2}, \cdots, t_{N}, t_{N+1}\right)$,那么$t_{N+1}$条件分布可以采用如下方式进行表示，并通过它对$t_{N+1}$进行预测
$$
P\left(t_{N+1} | D, A, B, X_{N+1}\right)=\frac{P\left(T_{N+1}| \{X_{n}\}, A, B, X_{N+1}\right)}{P\left(T_{N}\left|\left\{X_{n}\}, A, B\right)\right.\right.}
$$
根据贝叶斯法可推断出$t_{N+1}$的分布函数为
$$
P\left(t_{N+1} | D, C\left(X_{n}, X_{m} ; \Theta\right), X_{N+1}, \Theta\right)=\\
\frac{P\left(T_{N+1} | C\left(X_{n}, X_{m} ; \Theta\right), \Theta, X_{N+1},\left\{X_{n}\right\}\right)}{P\left(T_{N}\left|C\left(X_{n}, X_{m} ; \Theta\right), \Theta,\left\{X_{n} \}\right)\right.\right.}
$$
代入高斯分布公式，简化后得：
$$
P\left(t_{N+1} | D, C\left(X_{n}, X_{m} ; \Theta\right), \Theta, X_{N+1}\right)=\frac{1}{Z} \exp \left(-\frac{\left(t_{N+1}-\hat{t}_{N+1}\right)^{2}}{2 \sigma_{\hat{i}_{N+1}}^{2}}\right)
$$

* $\hat{t}_{N+1}$为期望值

根据期望和方差可以进行预测。

#### 预测结果及分析 ####

* 绿色的线表示：`predictive output mean` 预测输出均值，根据该值进行预测，可以看到该值对真实值的拟合还是具有一定准确性的，尤其是热度变化较为稳定的部分。
* 蓝色的点表示：用来训练的真实值
* 粉色的点表示：模型预测的值
* 紫色的点表示：预测的值对应的真实值

> 8月份猪瘟话题，根据前30天的值预测最后一天的热度

![1565526327304](周报-第6周-王子昂.assets/1565526327304.png)

> 8月份猪瘟话题，根据前10天的值预测未来五天的热度趋势

![1565526233924](周报-第6周-王子昂.assets/1565526233924.png)

* 从图中可以看出预测输出均值对真实热度值得拟合还是比较准确的，对于热度变化不稳定得区域，该模型对热度趋势的预测还是比较准确的，对于热度变化稳定的区域，如图(2)所示，对未来5天的预测基本都是准确的（紫色的真实值与粉色的预测值重合）
* 但由于数据和时间的限制，并没有进行大规模的测试，很难得到该模型的预测准确率，并不能很好的衡量模型的预测效果
* 在GPR的应用中，参数对性能的影响至关重要，目前常采用共扼梯度法确定最优参数，但共扼梯度法存在对初始值敏感、易陷入局最优等弊端，对GPR预测性能产生不利影响，对于舆情热度的预测，可以考虑采用入侵杂草优化(IWO)对参数进行优化。

### 其他预测方法 ###

> 目前对微博舆情趋势预测的研究，主要有基于传统统计学的预测方法和以机器学习为基础的预测方法

基于传统统计学的预测方法，预测方法参数设置少，容易实现但大都是对微博舆情的线性建模，不能够有效体现出微博信息非线性变化的特点，预测结果往往缺乏准确性：

* 基于时间序列的预测方法
* 采用马尔科夫链的方法建立模型对舆情热度趋势进行预测
* 利用指数平滑法对微博舆情未来发展趋势进行预测

以机器学习为基础的预测方法，主要是利用机器学习中的逻辑回归模型建立基于行为预测的微博信息传播模型，相比较传统统计学方法其预测结果的精确度有一定的提高，但逻辑回归模型的自变量间存在的多重共线性会影响预测结果的准确性，神经网络方法的网络结构复杂且存在易出现过度拟合的缺陷：

* 基于神经网络结合遗传算法和模拟退火算法的微博舆情趋势预测方法

## 听取清华讲座总结PPT ##

